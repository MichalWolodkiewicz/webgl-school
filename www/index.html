<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" src="js/libs.js"></script>
    <script type="text/javascript" src="js/glUtils.js"></script>
    <script type="text/javascript" src="js/gl_script.js"></script>
    <style type="text/css">
        .ui-property-box {
            margin-top: 5px;
            margin-bottom: 5px;
            border: 1px dashed black;
        }
    </style>
</head>
<body onload="initWebGL(); initLogger();" style="text-align: center;">
<div>
    <div style="float:left;width:25%" id="ui">
        <div class="ui-property-box">
            <b>Translation:</b><br/>
            X<input type="range" id="translation_x" oninput="onTranslationInputChange('x')" min="-150" max="150"
                    step="1"><br/>
            Y<input type="range" id="translation_y" oninput="onTranslationInputChange('y')" min="-150" max="150"
                    step="1"><br/>
            Z<input type="range" id="translation_z" oninput="onTranslationInputChange('z')" min="-150" max="150"
                    step="1"><br/>
        </div>
        <div id="kernelFilter" class="ui-property-box">
            <b>Kernel filter:</b><br/>
        </div>
        <div class="ui-property-box">
            <b>Scale:</b><br/>
            <input type="range" id="scaleInput" oninput="onScaleInputChange()" min="1" max="200"
                   step="1"><br/>
        </div>
        <div class="ui-property-box">
            <b>Number of squares:</b><span id="numberOfSquaresLabel"></span></span><br/>
            <input type="range" id="squaresNumber" onchange="onSquaresNumberInputChange()" min="1" max="16"
                   step="1"><br/>
        </div>
    </div>
    <div style="float:right;width:75%">
        <canvas width="600px" height="600px" id="glCanvas"></canvas>
    </div>
</div>
<script id="shader-vs" type="x-shader/x-fragment">
    attribute vec3 position;
    attribute vec2 a_tex_coords;
    varying vec2 tex_coords;
    uniform mat4 Pmatrix;
    uniform mat4 Vmatrix;
    uniform mat4 MmatrixY;
    uniform vec3 u_translation;
    uniform mat4 u_scale;
    void main(void) {
        gl_Position = Pmatrix*Vmatrix*MmatrixY*u_scale*(vec4(position, 1.)+vec4(u_translation, 0.0));
        tex_coords = a_tex_coords;
    }
</script>
<script id="shader-fs" type="x-shader/x-fragment">
    precision mediump float;
    varying vec2 tex_coords;
    uniform sampler2D u_image;
    void main(void) {
        gl_FragColor = texture2D(u_image, tex_coords);
    }
</script>

<script id="shader-convultion-fs" type="x-shader/x-fragment">
     precision mediump float;
     varying vec2 tex_coords;
     uniform sampler2D u_image;
     //convultion effect variables
     uniform vec2 u_textureSize;
     uniform float u_kernel[9];
     uniform float u_kernelWeight;
     void main(void) {
         vec2 onePixel = vec2(1.0, 1.0) / u_textureSize;
         vec4 colorSum =
         texture2D(u_image, tex_coords + onePixel * vec2(-1, -1)) * u_kernel[0] +
         texture2D(u_image, tex_coords + onePixel * vec2( 0, -1)) * u_kernel[1] +
         texture2D(u_image, tex_coords + onePixel * vec2( 1, -1)) * u_kernel[2] +
         texture2D(u_image, tex_coords + onePixel * vec2(-1,  0)) * u_kernel[3] +
         texture2D(u_image, tex_coords + onePixel * vec2( 0,  0)) * u_kernel[4] +
         texture2D(u_image, tex_coords + onePixel * vec2( 1,  0)) * u_kernel[5] +
         texture2D(u_image, tex_coords + onePixel * vec2(-1,  1)) * u_kernel[6] +
         texture2D(u_image, tex_coords + onePixel * vec2( 0,  1)) * u_kernel[7] +
         texture2D(u_image, tex_coords + onePixel * vec2( 1,  1)) * u_kernel[8] ;
         gl_FragColor = vec4((colorSum / u_kernelWeight).rgb, 1.0);
    }
</script>

</body>
</html>